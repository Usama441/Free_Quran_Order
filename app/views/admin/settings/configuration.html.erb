<% content_for :title, "Configuration - Quran Admin" %>

    <h2 class="text-3xl font-bold text-green-700 mb-6 flex items-center space-x-2">
      <i class="fas fa-cog"></i><span>System Configuration</span>
    </h2>

<%= form_with url: admin_configuration_path, method: :patch, class: "space-y-8" do |f| %>
  <!-- General Settings -->
  <div class="bg-white shadow-lg rounded-xl p-6">
    <h3 class="text-xl font-semibold text-green-700 mb-4 flex items-center space-x-2">
      <i class="fas fa-info-circle"></i><span>General Settings</span>
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Site Name</label>
        <input type="text" name="app[site_name]" value="<%= @app_settings['site_name'] %>" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
        <p class="text-xs text-gray-500 mt-1">Name displayed in website header</p>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Default Translation</label>
        <select name="app[default_translation]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
          <option value="english" <%= @app_settings['default_translation'] == 'english' ? 'selected' : '' %>>English</option>
          <option value="urdu" <%= @app_settings['default_translation'] == 'urdu' ? 'selected' : '' %>>Urdu</option>
          <option value="french" <%= @app_settings['default_translation'] == 'french' ? 'selected' : '' %>>French</option>
          <option value="spanish" <%= @app_settings['default_translation'] == 'spanish' ? 'selected' : '' %>>Spanish</option>
        </select>
        <p class="text-xs text-gray-500 mt-1">Default language for new orders</p>
      </div>
    </div>
  </div>

  <!-- Order Management -->
  <div class="bg-white shadow-lg rounded-xl p-6">
    <h3 class="text-xl font-semibold text-blue-700 mb-4 flex items-center space-x-2">
      <i class="fas fa-shopping-cart"></i><span>Order Management</span>
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Order Limit Per Day</label>
        <input type="number" name="app[order_limit_per_day]" value="<%= @app_settings['order_limit_per_day'] %>" min="1" max="1000" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        <p class="text-xs text-gray-500 mt-1">Maximum orders per day</p>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Max Daily Orders</label>
        <input type="number" name="app[max_daily_orders]" value="<%= @app_settings['max_daily_orders'] %>" min="1" max="10000" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        <p class="text-xs text-gray-500 mt-1">Absolute daily order limit</p>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Auto-refresh Interval</label>
        <select name="app[auto_refresh_interval]" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="30" <%= @app_settings['auto_refresh_interval'] == 30 ? 'selected' : '' %>>30 seconds</option>
          <option value="60" <%= @app_settings['auto_refresh_interval'] == 60 ? 'selected' : '' %>>1 minute</option>
          <option value="300" <%= @app_settings['auto_refresh_interval'] == 300 ? 'selected' : '' %>>5 minutes</option>
          <option value="600" <%= @app_settings['auto_refresh_interval'] == 600 ? 'selected' : '' %>>10 minutes</option>
        </select>
        <p class="text-xs text-gray-500 mt-1">Dashboard update frequency</p>
      </div>
    </div>
  </div>

  <!-- System Preferences -->
  <div class="bg-white shadow-lg rounded-xl p-6">
    <h3 class="text-xl font-semibold text-purple-700 mb-4 flex items-center space-x-2">
      <i class="fas fa-sliders-h"></i><span>System Preferences</span>
    </h3>
    <div class="space-y-4">
      <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
        <div>
          <h4 class="font-medium text-gray-800">Email Notifications</h4>
          <p class="text-sm text-gray-600">Enable system-wide email notifications</p>
        </div>
        <label class="relative inline-flex items-center cursor-pointer">
          <input type="hidden" name="app[email_notifications]" value="false">
          <input type="checkbox" name="app[email_notifications]" value="true" <%= @app_settings['email_notifications'] ? 'checked' : '' %> class="sr-only peer">
          <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-[.75rem] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
        </label>
      </div>

      <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
        <div>
          <h4 class="font-medium text-gray-800">Debug Mode</h4>
          <p class="text-sm text-gray-600">Show detailed error messages and debug info</p>
        </div>
        <label class="relative inline-flex items-center cursor-pointer">
          <input type="hidden" name="app[debug_mode]" value="false">
          <input type="checkbox" name="app[debug_mode]" value="true" <%= @app_settings['debug_mode'] ? 'checked' : '' %> class="sr-only peer">
          <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-[.75rem] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
        </label>
      </div>

      <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
        <div>
          <h4 class="font-medium text-gray-800">Maintenance Mode</h4>
          <p class="text-sm text-gray-600">Temporarily disable public access for maintenance</p>
        </div>
        <label class="relative inline-flex items-center cursor-pointer">
          <input type="hidden" name="app[maintenance_mode]" value="false">
          <input type="checkbox" name="app[maintenance_mode]" value="true" <%= @app_settings['maintenance_mode'] ? 'checked' : '' %> class="sr-only peer">
          <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-[.75rem] peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"></div>
        </label>
      </div>
    </div>
  </div>

  <!-- Inventory Settings -->
  <div class="bg-white shadow-lg rounded-xl p-6">
    <h3 class="text-xl font-semibold text-orange-700 mb-4 flex items-center space-x-2">
      <i class="fas fa-warehouse"></i><span>Inventory Settings</span>
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Low Stock Threshold</label>
        <input type="number" name="app[low_stock_threshold]" value="<%= @app_settings['low_stock_threshold'] %>" min="1" max="1000" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
        <p class="text-xs text-gray-500 mt-1">Units remaining before low stock alert</p>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Auto-reorder Point</label>
        <input type="number" name="app[auto_reorder_point]" value="<%= @app_settings['auto_reorder_point'] %>" min="1" max="500" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
        <p class="text-xs text-gray-500 mt-1">Units before automatic reorder recommendation</p>
      </div>
    </div>
  </div>

    <!-- Current System Status -->
<div class="bg-white shadow-lg rounded-xl p-6">
  <h3 class="text-xl font-semibold text-gray-700 mb-4 flex items-center space-x-2">
    <i class="fas fa-server"></i><span>System Status</span>
    <span class="text-sm px-2 py-1 rounded-full 
      <%= @system_status[:system_health] == 'excellent' ? 'bg-green-100 text-green-800' : '' %>
      <%= @system_status[:system_health] == 'good' ? 'bg-blue-100 text-blue-800' : '' %>
      <%= @system_status[:system_health] == 'fair' ? 'bg-yellow-100 text-yellow-800' : '' %>
      <%= @system_status[:system_health] == 'poor' ? 'bg-red-100 text-red-800' : '' %>">
      <%= @system_status[:system_health].titleize %>
    </span>
  </h3>
  
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
    <!-- Database Status -->
    <div class="flex items-center space-x-3 p-3 
      <%= @system_status[:database][:healthy] ? 'bg-green-50 border-l-4 border-green-500' : 'bg-red-50 border-l-4 border-red-500' %>">
      <i class="fas <%= @system_status[:database][:healthy] ? 'fa-check-circle text-green-600' : 'fa-times-circle text-red-600' %>"></i>
      <div>
        <div class="font-medium text-sm">Database</div>
        <div class="text-xs text-gray-600"><%= @system_status[:database][:message] %></div>
      </div>
    </div>

    <!-- Background Jobs Status -->
    <div class="flex items-center space-x-3 p-3 
      <%= @system_status[:background_jobs][:healthy] ? 'bg-green-50 border-l-4 border-green-500' : 'bg-red-50 border-l-4 border-red-500' %>">
      <i class="fas <%= @system_status[:background_jobs][:healthy] ? 'fa-check-circle text-green-600' : 'fa-times-circle text-red-600' %>"></i>
      <div>
        <div class="font-medium text-sm">Background Jobs</div>
        <div class="text-xs text-gray-600"><%= @system_status[:background_jobs][:message] %></div>
        <% if @system_status[:background_jobs][:details] %>
          <div class="text-xs text-gray-500 mt-1">
            Processed: <%= number_with_delimiter(@system_status[:background_jobs][:details][:processed]) %>
          </div>
        <% end %>
      </div>
    </div>

    <!-- File Storage Status -->
    <div class="flex items-center space-x-3 p-3 
      <%= @system_status[:file_storage][:healthy] ? 'bg-green-50 border-l-4 border-green-500' : 'bg-red-50 border-l-4 border-red-500' %>">
      <i class="fas <%= @system_status[:file_storage][:healthy] ? 'fa-check-circle text-green-600' : 'fa-times-circle text-red-600' %>"></i>
      <div>
        <div class="font-medium text-sm">File Storage</div>
        <div class="text-xs text-gray-600"><%= @system_status[:file_storage][:message] %></div>
      </div>
    </div>

    <!-- Redis Status -->
    <div class="flex items-center space-x-3 p-3 
      <%= @system_status[:redis][:healthy] ? 'bg-green-50 border-l-4 border-green-500' : 'bg-red-50 border-l-4 border-red-500' %>">
      <i class="fas <%= @system_status[:redis][:healthy] ? 'fa-check-circle text-green-600' : 'fa-times-circle text-red-600' %>"></i>
      <div>
        <div class="font-medium text-sm">Redis</div>
        <div class="text-xs text-gray-600"><%= @system_status[:redis][:message] %></div>
      </div>
    </div>
  </div>

  <div class="mt-6 p-4 bg-gray-50 rounded-lg">
    <div class="flex justify-between items-center mb-2">
      <span class="text-sm font-medium">Last System Check:</span>
      <span class="text-sm text-gray-600"><%= @system_status[:last_check].strftime('%Y-%m-%d %H:%M:%S') %></span>
    </div>
    <div class="flex justify-between items-center">
      <span class="text-sm font-medium">Uptime:</span>
      <span class="text-sm text-gray-600"><%= @system_status[:uptime] %></span>
    </div>
    <div class="flex justify-between items-center mt-2">
      <span class="text-sm font-medium">Overall Health:</span>
      <span class="text-sm font-medium 
        <%= @system_status[:system_health] == 'excellent' ? 'text-green-600' : '' %>
        <%= @system_status[:system_health] == 'good' ? 'text-blue-600' : '' %>
        <%= @system_status[:system_health] == 'fair' ? 'text-yellow-600' : '' %>
        <%= @system_status[:system_health] == 'poor' ? 'text-red-600' : '' %>">
        <%= @system_status[:system_health].titleize %>
      </span>
    </div>
  </div>

  <!-- Refresh Button -->
  <div class="mt-4 flex justify-end">
    <%= button_to admin_configuration_path, method: :get, class: "bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition text-sm flex items-center space-x-2" do %>
      <i class="fas fa-sync-alt"></i>
      <span>Refresh Status</span>
    <% end %>
  </div>
</div>

      <!-- Save and Advanced Actions -->
      <div class="flex justify-between items-center">
        <div class="flex space-x-3">
          <button type="button" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition text-sm">
            <i class="fas fa-undo"></i> Reset to Defaults
          </button>
          <button type="button" class="bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition text-sm">
            <i class="fas fa-tools"></i> Advanced Settings
          </button>
        </div>

        <button type="submit" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition flex items-center space-x-2">
          <i class="fas fa-save"></i>
          <span>Save Configuration</span>
        </button>
      </div>
    <% end %>